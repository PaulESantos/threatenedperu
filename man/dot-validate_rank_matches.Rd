% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/matching-pipeline.R
\name{.validate_rank_matches}
\alias{.validate_rank_matches}
\title{Validate Rank Matches to Prevent False Positives}
\usage{
.validate_rank_matches(matched_results, use_infraspecies_2)
}
\arguments{
\item{matched_results}{List with matched and unmatched records from pipeline}

\item{use_infraspecies_2}{Logical, whether Rank 4 is supported}
}
\value{
List with:
  \item{combined}{All records with valid_rank column}
  \item{valid_matches}{Only records with valid rank correspondence}
  \item{invalid_matches}{Records rejected due to rank mismatch}
  \item{unmatched}{Records that never matched}
}
\description{
**CRITICAL FUNCTION:** Validates that the declared rank (user input) matches
the matched rank (database). This prevents false positives where:

- User inputs: "Cattleya maxima var. alba" (Rank 3, doesn't exist)
- Database has: "Cattleya maxima" (Rank 2, exists)
- Without validation: Would incorrectly return "Threatened"
- With validation: Correctly rejects match, returns "Not threatened"
}
\keyword{internal}
